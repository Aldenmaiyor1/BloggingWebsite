<link rel="stylesheet" href="/css/articleDemo.css">

<input id="user_id_temp_storage" name="user_id_temp_storage" value="{{user_id}}" hidden>

<div id="article_container">
    <div id="specific_category_title"><span id="articles_home"><a href="/">All</a></span> / <span
            id="current_category">{{current_category}}</span>
    </div>

    {{!-- Displaying article content --}}
    <div id="article-div">
        <p id="article_title"><strong>Title:</strong> {{article.[0].title}}</p>

        <div>
            <img src="/images/article-images/thumbnails/{{article.[0].image}}" alt="{{article.[0].image}}">
        </div>
        <div id="author_details">
            <div id="author_icon">{{author_icon}}</div>
            <p id="author_name"> <strong>By</strong> {{authorName.[0].author_fname}} {{authorName.[0].author_lname}}</p>
            <p id="article_timestamp"><strong>Published on</strong> {{article.[0].date_of_publish}}</p>
        </div>

        <div id="article_content" style="border: red solid 2px;">
            {{{article.[0].content_html}}}
        </div>
        <input id="article_id_temp_storage" name="article_id_temp_storage" value="{{article.[0].id}}" hidden>

        <hr>
        <div>
            <button id="comment-section-opener">See comments</button>
        </div>
        {{#if comments}}

        <div id="comments-div">
            <div>
                <form id="comment_on_article_form">
                    <textarea name="comment_content" placeholder="comment on this article!" required></textarea>
                    <button id="commentOnArticleButton" type="submit">Submit</button>
                </form>
            </div>
            {{#each comments}}
            <div>
                <span>{{this.username}}</span>
                <span>{{this.fname}}</span>
                <span>{{this.lname}}</span>
                <span>{{this.content}}</span>
                <span>{{this.time_of_comment}}</span>
                <button class="textareaOpener">Comment</button>
                <div>
                    <form class="comment_on_comment_form">
                        <input name="comment_id_storage" value="{{this.id}}" hidden>
                        <textarea name="comment_content" placeholder="leave your comments here" required></textarea>
                        <button class="commentSubmitButton">Submit</button>
                    </form>
                </div>
                <div>
                    <!-- these three element in the div must next to each other, if anyone modify CSS, should keep this in mind -->
                    <input name="comment_id_temp_storage" value="{{this.id}}" hidden>
                    <button class="deleteCommentButton">delete</button>
                    <input name="commenter_id_temp_storage" value="{{this.user_id}}" hidden>
                </div>
                {{#if this.second_level_comments}}
                {{#each this.second_level_comments}}
                <div>
                    <span>{{this.username}}</span>
                    <span>{{this.fname}}</span>
                    <span>{{this.lname}}</span>
                    <span>{{this.content}}</span>
                    <span>{{this.time_of_comment}}</span>
                    <button class="textareaOpener">Comment</button>
                    <div>
                        <form class="comment_on_comment_form">
                            <input name="comment_id_storage" value="{{this.id}}" hidden>
                            <textarea name="comment_content" placeholder="leave your comments here" required></textarea>
                            <button class="commentSubmitButton">Submit</button>
                        </form>
                    </div>
                    <div>
                        <!-- these three element in the div must next to each other, if anyone modify CSS, should keep this in mind -->
                        <input name="comment_id_temp_storage" value="{{this.id}}" hidden>
                        <button class="deleteCommentButton">delete</button>
                        <input name="commenter_id_temp_storage" value="{{this.user_id}}" hidden>
                    </div>
                    {{#if this.third_level_comments}}
                    {{#each this.third_level_comments}}
                    <div>
                        <span>{{this.username}}</span>
                        <span>{{this.fname}}</span>
                        <span>{{this.lname}}</span>
                        <span>{{this.content}}</span>
                        <span>{{this.time_of_comment}}</span>
                        <div>
                            <!-- these three element in the div must next to each other, if anyone modify CSS, should keep this in mind -->
                            <input name="comment_id_temp_storage" value="{{this.id}}" hidden>
                            <button class="deleteCommentButton">delete</button>
                            <input name="commenter_id_temp_storage" value="{{this.user_id}}" hidden>
                        </div>
                    </div>
                    {{/each}}
                    {{/if}}
                </div>
                {{/each}}
                {{/if}}
            </div>
            {{/each}}
        </div>
        {{else}}
        <p>This article has no comments</p>
        {{/if}}
    </div>

    {{!-- JS linked with comment feature --}}
    <script src="/script/comment.js"></script>

    <!-- The codes below are previous version, i commented it out instead of delete them, because
    for those of you working on CSS, might need to reference on the id or class below to delete ununsed code.
    By Tony.
    -->


    {{!-- Displaying like button --}}

    {{!-- <div id="like_section">
        <div id="like">

            <button class="like-btn">
                <i class="fa-regular fa-thumbs-up" id="like-icon"></i>
                {{like_count.[0].like_count}}
            </button>
        </div> --}}

        {{!-- This anchor tag for testing purpose only --}}
        {{!-- <a href="/writeArticle">Write article</a>
        <hr> --}}

        {{!-- Displaying comment section --}}

        {{!-- <button id="open-comment">Comment
        </button>

        <div class="comment hidden">
            <form class="comment-form">
                <button id="close-comment">Cancel</button>
                <textarea name="comments" id="comments_id" placeholder="Add your comment here..." rows="5"
                    cols="60"></textarea>
                <input type="submit" name="submit_button" value="Respond!" />

            </form>

            <div>
                {{#if comments}}
                {{#each comments}}
                <div class="comment_details">
                    <p class="comment_content"><strong>Comment:</strong> {{this.content}}</p>
                    <p class="comment_by_name">{{this.comment.name}}</p>
                    <div class="comment_by_icon">{{this.comment.icon}}</div>
                    <p class="comment_by_timestamp"><strong>Time:</strong> {{this.time_of_comment}}</p>
                    <div>
                        {{#if replies}}
                        {{#each replies}}
                        <div style="border: 1px solid red; margin-left: 20px">
                            <p><strong>Replied on </strong>{{this.time_of_comment}}</p>
                            <p><strong>Replies: </strong>{{this.content}}</p>
                        </div>
                        {{/each}}
                        {{/if}}
                    </div>
                </div>
                {{/each}}
                {{else}}
                <div id="comments_title">Comments (0)</div>
                <div id="comments_container">This article has not had comment yet...</div>
                {{/if}}
            </div>
        </div> --}}