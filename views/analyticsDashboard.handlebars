<div id="keyMetricsTitleDiv">
    {{#if user}}
    <h2 id="keyMetricsTitle"> <img src="{{user.user_icon}}"> {{user.fname}}'s Analytics Dashboard</h2>
    {{else}}
    <h2 id="keyMetricsTitle">Analytics Dashboard</h2>
    {{/if}}
</div>

<div class="analyticsContainer">
    <div class="analyticsDashboard">
        <div class="keyMetricsDiv">
            <div class="indvKeyMetrics" id="followersDiv">
                {{#if followers}}
                <div id="followersIcon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="white" class="bi bi-people"
                        viewBox="0 0 16 16">
                        <path
                            d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" />
                    </svg>
                </div>
                <div id="followerNumberDiv">
                    <p id="followerNumber">{{followers}}</p>
                </div>
                {{else}}
                {{!-- <div class="followerUpperDiv"> --}}
                    <div id="followersIcon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="white" class="bi bi-people"
                            viewBox="0 0 16 16">
                            <path
                                d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" />
                        </svg>
                    </div>
                    <p id="followerNumber">5</p>
                    {{!--
                </div> --}}
                {{/if}}
                <h3 id="followerTitle">Total Followers</h3>
            </div>

            <div class="indvKeyMetrics" id="commentsDiv">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc" class="bi bi-chat-text"
                    viewBox="0 0 16 16">
                    <path
                        d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z" />
                    <path
                        d="M4 5.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8zm0 2.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5z" />
                </svg>
                <h3>Total Comments per Article</h3>
                {{#if comments}}
                {{#each comments}}
                {{#if this.comments_count}}
                <span class="articleWithComments">{{this.title}}</span> <span>- {{this.comments_count}} comments</span>
                <br>
                {{else}}
                <span class="articleWithComments">{{this.title}}</span> <span>- 0 comments</span>
                <br>
                {{/if}}            
                {{/each}}
                {{else}}

                {{/if}}
            </div>

            <div class="indvKeyMetrics" id="likesDiv">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc" class="bi bi-valentine"
                    viewBox="0 0 16 16">
                    <path
                        d="M8 5.993c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132ZM2.25 4a.25.25 0 0 0-.25.25v1.5a.25.25 0 0 0 .5 0V4.5h1.25a.25.25 0 0 0 0-.5h-1.5Zm10 0a.25.25 0 1 0 0 .5h1.25v1.25a.25.25 0 1 0 .5 0v-1.5a.25.25 0 0 0-.25-.25h-1.5ZM2.5 10.25a.25.25 0 1 0-.5 0v1.5c0 .138.112.25.25.25h1.5a.25.25 0 1 0 0-.5H2.5v-1.25Zm11.5 0a.25.25 0 1 0-.5 0v1.25h-1.25a.25.25 0 1 0 0 .5h1.5a.25.25 0 0 0 .25-.25v-1.5Z" />
                    <path fill-rule="evenodd"
                        d="M0 2.994v-.06a1 1 0 0 1 .859-.99l13-1.857a1 1 0 0 1 1.141.99V2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V2.994ZM1 3v10h14V3H1Z" />
                </svg>
                <h3>Total Likes per Article</h3>
                {{#if likes}}
                {{#each likes}}
                {{#if this.like_count}}
                <span class="articleWithComments">{{this.title}}</span> <span>- {{this.like_count}} likes</span>
                <br>
                {{else}}
                <span class="articleWithComments">{{this.title}}</span> <span>- 0 likes</span>
                <br>
                {{/if}}
                {{/each}}
                {{else}}
                {{/if}}
            </div>

        </div>


        <div class="topThreeDiv">
            {{!-- {{#if user}}
            <h2 id="topThreeTitle"> {{this.fname}}'s TOP 3 ARTICLES</h2>
            {{else}} --}}
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc" class="bi bi-award"
                viewBox="0 0 16 16">
                <path
                    d="M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68L9.669.864zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702 1.509.229z" />
                <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z" />
            </svg>
            <h2 id="topThreeTitle">TOP 3 ARTICLES</h2>
            {{!-- {{/if}} --}}

            {{#if topArticles}}
            <div class="indvTopArticles">
                {{#each topArticles}}
                {{!-- <img src="{{this.article_thumbnail}}" alt="{{this.article_name}}" style="width:500px;height:600px;"> --}}
                <ul>
                    <li>Rank: {{this.index}}</li>
                    <li>Title: {{this.title}}</li>
                    <li>Number of Comments: {{this.comments_count}}</li>
                    <li>Number of Likes: {{this.like_count}}</li>
                    <li>Popularity Metric: {{this.popularity}}</li>
                    {{!-- <li>Creation Time: {{this.creation_period}}</li> --}}
                </ul>
                {{/each}}
                {{else}}
                {{!-- <p>You have no top articles...do better?</p> --}}
                <div class="eachTopArticle">
                    <div class="topArticlesIcons">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc"
                            class="bi bi-1-square" viewBox="0 0 16 16">
                            <path d="M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383h1.312Z" />
                            <path
                                d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2Z" />
                        </svg>
                    </div>
                    <div class="topArticleSummaries">
                        <div>Title: </div>
                        <div>Number of Comments: </div>
                        <div>Number of Likes: </div>
                        <div>Popularity Metric: </div>
                        <div>Creation Time: </div>
                    </div>
                </div>
                <div class="eachTopArticle">
                    <div class="topArticlesIcons">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc"
                            class="bi bi-2-square" viewBox="0 0 16 16">
                            <path
                                d="M6.646 6.24v.07H5.375v-.064c0-1.213.879-2.402 2.637-2.402 1.582 0 2.613.949 2.613 2.215 0 1.002-.6 1.667-1.287 2.43l-.096.107-1.974 2.22v.077h3.498V12H5.422v-.832l2.97-3.293c.434-.475.903-1.008.903-1.705 0-.744-.557-1.236-1.313-1.236-.843 0-1.336.615-1.336 1.306Z" />
                            <path
                                d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2Z" />
                        </svg>
                    </div>
                    <div class="topArticleSummaries">
                        <div>Title: </div>
                        <div>Number of Comments: </div>
                        <div>Number of Likes: </div>
                        <div>Popularity Metric: </div>
                        <div>Creation Time: </div>
                    </div>
                </div>
                <div class="eachTopArticle">
                    <div class="topArticlesIcons">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc"
                            class="bi bi-3-square" viewBox="0 0 16 16">
                            <path
                                d="M7.918 8.414h-.879V7.342h.838c.78 0 1.348-.522 1.342-1.237 0-.709-.563-1.195-1.348-1.195-.79 0-1.312.498-1.348 1.055H5.275c.036-1.137.95-2.115 2.625-2.121 1.594-.012 2.608.885 2.637 2.062.023 1.137-.885 1.776-1.482 1.875v.07c.703.07 1.71.64 1.734 1.917.024 1.459-1.277 2.396-2.93 2.396-1.705 0-2.707-.967-2.754-2.144H6.33c.059.597.68 1.06 1.541 1.066.973.006 1.6-.563 1.588-1.354-.006-.779-.621-1.318-1.541-1.318Z" />
                            <path
                                d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2Z" />
                        </svg>
                    </div>
                    <div class="topArticleSummaries">
                        <div>Title: </div>
                        <div>Number of Comments: </div>
                        <div>Number of Likes: </div>
                        <div>Popularity Metric: </div>
                        <div>Creation Time: </div>
                    </div>
                </div>
                {{/if}}
            </div>
        </div>



        {{!-- PLOT --}}
        <script src="https://cdn.plot.ly/plotly-2.26.0.min.js" charset="utf-8"></script>
        <div class="furtherData">
            <div id="dataIcon">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7fc7cc"
                    class="bi bi-clipboard-data" viewBox="0 0 16 16">
                    <path
                        d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z" />
                    <path
                        d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
                    <path
                        d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
                </svg>
            </div>
            <div id="plot" style="width:600px;height:250px;"></div>
        </div>

        <script>
            const date = new Date();
            console.log("" + (date.getDate()) +"-"+ date.getMonth() +"-"+date.getFullYear())
            PLOT = document.getElementById("plot");
            var x1 = [1, 100, 10000];
            var y1 = [1, 5, 10];

            // Create a new array that contains only unique values
            var uniqueY1 = Array.from(new Set(y1));

            // Sort the x-axis values
            x1.sort();

            var trace = {
                x: x1,
                y: uniqueY1,
                autobinx: false,
                histnorm: "count",
                marker: {
                    color: "#7fc7cc",
                    line: {
                        color: "rgba(255, 100, 102, 1)",
                        width: 0.5
                    }
                },
                opacity: 0.5,
                type: "histogram",
                xbins: null
            };

            var data = [trace];

            var layout = {
                bargap: 0.05,
                bargroupgap: 0.2,
                barmode: "group",

                xaxis: {
                    title: {
                        text: "Days",
                        font: {
                            family: "Times New Roman",
                            size: 20,
                            color: "rgb(19, 27, 65)"
                        }
                    },
                },

                yaxis: {
                    title: {
                        text: "Total Likes",
                        font: {
                            family: "Times New Roman",
                            size: 20,
                            color: "rgb(19, 27, 65)"
                        }
                    }
                }
            };
            Plotly.newPlot("plot", data, layout);
        </script>
    </div>
</div>